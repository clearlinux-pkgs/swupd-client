From 7ca4873b731d32cc55bfe59e050ba52d49738805 Mon Sep 17 00:00:00 2001
From: Icarus Sparry <icarus.w.sparry@intel.com>
Date: Thu, 26 Oct 2017 14:41:48 -0700
Subject: [PATCH] More a constant time check before a O(n) check

Hopefully will drop yet another cubic operation to quadratic

Signed-off-by: Icarus Sparry <icarus.w.sparry@intel.com>
---
 src/manifest.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/manifest.c b/src/manifest.c
index 409cb9d..964277b 100644
--- a/src/manifest.c
+++ b/src/manifest.c
@@ -1230,10 +1230,10 @@ void link_renames(struct list *newfiles, struct manifest *from_manifest)
 			if (!file2->is_deleted) {
 				continue;
 			}
-			if (!file_found_in_manifest(from_manifest, file2)) {
+			if (!hash_equal(file2->hash, file1->hash)) {
 				continue;
 			}
-			if (hash_equal(file2->hash, file1->hash)) {
+			if (file_found_in_manifest(from_manifest, file2)) {
 				file1->deltapeer = file2->peer;
 				file1->peer = file2->peer;
 				file2->peer->deltapeer = file1;
-- 
2.14.3

